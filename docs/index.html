<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UTF-8 Simple Library for Internationalization: UTF8 - Simple Library for Internationalization</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="utf8-icon-small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UTF-8 Simple Library for Internationalization
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">UTF8 - Simple Library for Internationalization </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="mainpage"></a> Functions to facilitate Windows handling of I18N problems using the strategy advocated by <a href="http://utf8everywhere.org/">UTF-8 Everywhere Manifesto</a>.</p>
<h1>Purpose</h1>
<p>This is a library designed to simplify the usage of UTF-8 strings under Win32. While most of the (computing) world has standardized on using UTF-8 encoding, Win32 has remained stuck with wide character strings (also called UTF-16 encoding).</p>
<p>The library uses the principles outlined in the <a href="http://utf8everywhere.org/">UTF-8 Everywhere Manifesto</a> to make it easy to switch between the different character encodings.</p>
<h1>Content</h1>
<p>The main function groups are:</p><ul>
<li><a class="el" href="group__basecvt.html">Narrowing/widening functions</a></li>
<li><a class="el" href="group__charclass.html">Character classification functions</a></li>
<li><a class="el" href="group__folding.html">Case folding and case-insensitive comparison</a></li>
<li><a class="el" href="group__inifile.html">INI file replacement API</a></li>
</ul>
<p>There are also functions for:</p><ul>
<li>character counting - <a class="el" href="utf8_8cpp.html#afbcb53fd241b51ed4744eef1d7400a23" title="Counts number of characters in an UTF8 encoded string.">length()</a></li>
<li>string traversal - <a class="el" href="utf8_8cpp.html#a1c7f8749f24103988795c22575f1c99e" title="Advances a string iterator to next UTF-8 character.">next()</a></li>
<li>validity checking - <a class="el" href="utf8_8cpp.html#ab630a55b877a77ba64550357d0f387a3" title="Verifies if string is a valid UTF-8 string.">valid()</a></li>
</ul>
<p>In addition to those, there are wrappings commonly used C and C++ functions:</p><ul>
<li>file access operations: <a class="el" href="utf8_8h.html#a17111250dd542f9ed080a96cab913936" title="Open a file.">fopen()</a>, <a class="el" href="utf8_8h.html#af3ebab9439377a6a3f13542dbab4337c" title="Determines if a file has the requested access permissions.">access()</a>, <a class="el" href="utf8_8h.html#a5f0eb1fee50553ad4e55671f52c7f2ec" title="Delete a file.">remove()</a>, <a class="el" href="utf8_8h.html#a9a6a50a870135177fb98e9f2e0fb12d4" title="Changes the file access permissions.">chmod()</a>, <a class="el" href="utf8_8h.html#a1d0245cbb42146a80be6b62c718f61a6" title="Rename a file or directory.">rename()</a></li>
<li>directory operations: <a class="el" href="utf8_8h.html#aa6aefa08998a55dca4ba75312126e353" title="Creates a new directory.">mkdir()</a>, <a class="el" href="utf8_8h.html#a42637c506240d2a9bfb1d69dcd083645" title="Deletes a directory.">rmdir()</a>, <a class="el" href="utf8_8h.html#aabb576878dd9ae12de2f0ed0f854f1a4" title="Changes the current working directory.">chdir()</a>, <a class="el" href="utf8_8cpp.html#ad489d686670dff8206a2c45a7b237ef1" title="Gets the current working directory.">getcwd()</a></li>
<li>symbolic link creation: <a class="el" href="win_8cpp.html#ac1275556865f307d60296437899bcdef" title="Create a symbolic link.">symlink()</a></li>
<li>path management: <a class="el" href="utf8_8cpp.html#a5d0ef62a8f148b006b9c6fb6562446e0" title="Breaks a path name into components.">splitpath()</a>, <a class="el" href="utf8_8cpp.html#a07eb0dcaf69e2d9cbcd7d7b6f203f20a" title="Creates a path from UTF-8 encoded components.">makepath()</a></li>
<li>environment functions: <a class="el" href="utf8_8cpp.html#a445530e19aefad1fde92232c09f37a4f" title="Retrieves the value of an environment variable.">getenv()</a>, <a class="el" href="utf8_8h.html#a7efd70545eb2d60d5ec8136dfc3b37db" title="Creates, modifies, or removes environment variables.">putenv()</a></li>
<li>conversion of command-line arguments: <a class="el" href="utf8_8cpp.html#a86847074de33ea4eec2aa91ba500119b" title="Converts wide byte command arguments to an array of pointers to UTF-8 strings.">get_argv()</a> and <a class="el" href="utf8_8cpp.html#a611de942130d7b70ff9cfaaa79a1f005" title="Frees the memory allocated by get_argv(int *argc)">free_argv()</a></li>
<li>C++ I/O streams: <a class="el" href="classutf8_1_1ifstream.html">utf8::ifstream</a>, <a class="el" href="classutf8_1_1ofstream.html">utf8::ofstream</a>, <a class="el" href="classutf8_1_1fstream.html">utf8::fstream</a></li>
<li>File enumerating functions: <a class="el" href="win_8cpp.html#a86589b54792771e7c8833d41691e2f61" title="Searches a directory for a file or subdirectory with a name that matches a name (that can have wildca...">find_first()</a>, <a class="el" href="win_8cpp.html#a62db79c86ab71f2fa7cc10dbd6a77e52" title="Continues a search started by find_first() function.">find_next()</a></li>
<li>A <a class="el" href="classutf8_1_1file__enumerator.html">file enumerator</a> object wrapping find_first/find_next functions.</li>
<li>A simple <a class="el" href="classutf8_1_1buffer.html">buffer class</a> for handling Windows API parameters.</li>
<li><a class="el" href="classutf8_1_1_ini_file.html">IniFile</a> - a class for handling Windows "profile files" API.</li>
<li>Frequently used Windows functions like <a class="el" href="win_8cpp.html#a5c8bfa90bb0ba20781ec286f6c446d62">MessageBox</a> and <a class="el" href="win_8cpp.html#a05568d44a6186ba5f0c7295bb60e3be6">LoadString</a>.</li>
</ul>
<h1>Usage</h1>
<h2>General</h2>
<p>Before using this library you might want to review the guidelines from the <a href="http://utf8everywhere.org/">UTF-8 Everywhere Manifesto</a>. In particular:</p><ul>
<li>define UNICODE or _UNICODE in your program</li>
<li>for Visual Studio users, make sure "Use Unicode Character Set" option is defined under "General" &gt; "Project Defaults" tab.</li>
<li>for Visual Studio users, add "/utf-8" option under "C/C++" &gt; "All Options" &gt; "Additional Options" (see <a href="https://docs.microsoft.com/en-us/cpp/build/reference/utf-8-set-source-and-executable-character-sets-to-utf-8">https://docs.microsoft.com/en-us/cpp/build/reference/utf-8-set-source-and-executable-character-sets-to-utf-8</a>)</li>
<li>use only <em>std::string</em> and <em>char*</em> variables. Assume they all contain UTF-8 encoded strings.</li>
<li>use UTF-16 strings only in arguments to Windows API calls.</li>
</ul>
<p>All functions and classes in this library are included in the <em>utf8</em> namespace. It is a good idea not to have a using directive for this namespace. That makes it more evident in the code where UTF8-aware functions are used.</p>
<p>This is an example of a function call: </p><div class="fragment"><div class="line">string dirname = u8&quot;ελληνικό&quot;;</div>
<div class="line">utf8::mkdir (dirname);   //create a directory with a UTF8-encoded name</div>
</div><!-- fragment --><p> Most functions mimic the behavior of standard C functions. A notable exception is the <a class="el" href="utf8_8h.html#af3ebab9439377a6a3f13542dbab4337c" title="Determines if a file has the requested access permissions.">access()</a> function. The <a class="el" href="utf8_8h.html#af3ebab9439377a6a3f13542dbab4337c" title="Determines if a file has the requested access permissions.">utf8::access()</a> function returns a bool value while the standard library function returns 0 if the file can be accessed.</p>
<h2>I/O Streams</h2>
<p>Wrappers for C++ I/O streams can be used for file streams with UTF-8 encoded filenames. This is an example of a C++ stream with a weird name and content: </p><div class="fragment"><div class="line">string filename = u8&quot;ελληνικό&quot;;</div>
<div class="line">string filetext{ u8&quot;😃😎😛&quot; };</div>
<div class="line"> </div>
<div class="line">utf8::ofstream u8strm(filename);</div>
<div class="line"> </div>
<div class="line">u8strm &lt;&lt; filetext &lt;&lt; endl;</div>
<div class="line">u8strm.close ();</div>
</div><!-- fragment --><p> Translation from UTF-16 to UTF-8 applies only to file names. C++ streams are agnostic about their content.</p>
<p>Calling Windows API functions can be handled using the generic widening and narrowing functions like this example: </p><div class="fragment"><div class="line">string filename = u8&quot;ελληνικό&quot;;</div>
<div class="line">HANDLE f = CreateFile (utf8::widen (filename).c_str (), GENERIC_READ, 0,</div>
<div class="line">  NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);</div>
</div><!-- fragment --><h2>INI File Handling</h2>
<p>INI files, also called "profile files" in Microsoft parlance are still widely for storing application settings used either for compatibility reasons or because they are simple to work with.</p>
<p>The problem is that the basic Windows API calls for reading and writing INI files, <code>GetPrivateProfileString</code> and <code>PutPrivateProfileString</code>, combine both the file name and the information to be read or written in one API call. As an example, here is the signature of the <code>GetPrivateProfileStringW</code> function: </p><div class="fragment"><div class="line">DWORD GetPrivateProfileStringW(</div>
<div class="line">  LPCWSTR lpAppName,</div>
<div class="line">  LPCWSTR lpKeyName,</div>
<div class="line">  LPCWSTR lpDefault,</div>
<div class="line">  LPWSTR  lpReturnedString,</div>
<div class="line">  DWORD   nSize,</div>
<div class="line">  LPCWSTR lpFileName</div>
<div class="line">);</div>
</div><!-- fragment --><p> Using the <code>utf8::widen</code> function to convert all UTF-8 strings would produce an INI file that contains UTF-16 characters.</p>
<p>The solution is to completely forget about the Windows API functions and roll a new implementation for accessing INI files. This is by far not the only implementation of INI files that you can find out there. For a list of implementations you can check the <a href="https://en.wikipedia.org/wiki/INI_file">Wikipedia page</a>. This implementation struggles to be as compatible as possible with the original Windows API.</p>
<p>The only changes compared to the Windows API are:</p><ul>
<li>line length defaults to 1024 (the INI_BUFFER_SIZE value) while Windows limits it to 256 characters</li>
<li>files without a path are in current directory while Windows places them in Windows folder</li>
</ul>
<h2>Case Conversion</h2>
<p>Case conversion in Unicode is a much more complicated issue than ASCII case conversion. This library uses standard tables published by Unicode Consortium to perform upper case to lower case conversions. There is also a function <a class="el" href="group__folding.html#gaa65352f672803529414aaba45c30763f" title="Compare two strings in a case-insensitive way.">icompare()</a> that performs string comparison ignoring the case.</p>
<h1>Building</h1>
<p>The UTF8 library doesn't have any dependencies. The test programs however uses the <a href="https://github.com/neacsum/utpp">UTTP library</a>.</p>
<h1>License</h1>
<p>The MIT License (MIT)</p>
<p>Copyright (c) 2014-2021 Mircea Neacsu</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
